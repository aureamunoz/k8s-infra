- name: Install Dashboard
  shell: |
    kubectl --kubeconfig=$HOME/.kube/config \
      apply -f \
      https://raw.githubusercontent.com/kubernetes/dashboard/{{ k8s_dashboard_version }}/aio/deploy/recommended.yaml

- name: Copy Ingress yml file
  template:
    src: "ingress-dashboard.yml.j2"
    dest: /tmp/ingress-dashboard.yml

- name: Install the Ingress route
  shell: |
    kubectl --kubeconfig=$HOME/.kube/config apply -f /tmp/ingress-dashboard.yml

- name: Print kubernetes dashboard URL
  debug:
    msg:
      - "You can also view the kubernetes dashboard at"
      - "http://k8s-console.{{ k8s_dashboard_ingress_host }}/"
